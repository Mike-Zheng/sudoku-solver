<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="./glfx.js"></script>
    <script src="./tesseract.min.js"></script>
  </head>
  <body>
    <script>
      window.onload = function () {
        // try to create a WebGL canvas (will fail if WebGL isn't supported)
        try {
          var canvas = fx.canvas()
        } catch (e) {
          alert(e)
          return
        }

        // convert the image to a texture
        var image = document.getElementById('image')
        var texture = canvas.texture(image)
        // canvas.edgeWork(5);
        // apply the ink filter
        // canvas.brightnessContrast(-1, 1);

        canvas.draw(texture).update()

        // replace the image with the canvas
        image.parentNode.insertBefore(canvas, image)
        image.parentNode.removeChild(image)

        var worker = new Tesseract.TesseractWorker()
        var OEM = Tesseract.OEM

        worker
          .recognize(canvas.toDataURL(), 'eng', {
            init_oem: OEM.TESSERACT_ONLY,
            tessedit_char_whitelist: '0123456789',
          })
          .progress(function (p) {
            console.log(p)
          })
          .then(function (result) {
            console.log(result)
            console.log(result.text)
          })
      }
    </script>
    <img id="image" src="./23634.jpg" />
  </body>

  <script></script>
</html>
